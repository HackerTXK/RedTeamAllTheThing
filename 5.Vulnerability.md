# Exploit Vulnerabilities 

## Automated and Manual Vulnerability Research 
* exploit DB  
* NVD 
* Rapid7 
* github  
    - search "poc" "vulnerability" "cve" 
* Searchsploit 



-------------------------------------
open redirect   
xss  
broken access control  
--------------------------------------


# Section 1: Web Vulnerabilities
## 1. Upload Vulnerabilities  
### Overwriting Existing Files
The Key: upload the same file name 


### RCE 
enumeration upload point-->gobuster

#### php webshell
```php
<?php
    echo system($_GET["cmd"]);
?>
```
#### reverse/bind shells 
[pentestmonkey](https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet)  
[php reverse shell](https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php)

### Filtering 
- Extension Validation
- File Type Filtering 
    - [MIME validation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types)
    - Magic Number validation  
        at the very beginning of the file content
- File Length Filtering
- File Name Filtering 
- File Content Filtering
- File Content Filtering 
### Bypassing Client-Side Filtering
- Turn off Javascript 
- Intercept and modify the incoming page (burp)
- Intercept and modify the file upload
- curl
### Bypassing Server-Side Filtering: File Extensions

- `.phtml .php3 .php4 .php5 .php7 .phps .php-s .pht .phar .pht .phps`  
- `.jpg.php`

### Bypassing Server-Side Filtering: Magic Numbers   
[List of file signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)

### Methodology
1. Recon   
goal: *what languages and frameworks the web use*
    - manual
    - Wappalyzer
    - burp reponse header 
    - `httpx -td -u uber.com`
2. search upload point 
    - manual  `site:example.com "choose file"`
    - code review determine if there are any client-side filters to bypass
3. upload a innocent file  
    goal: determine how our file is accessed
    >can we access it directly in an uploads folder? Is it embedded in a page somewhere? What's the naming scheme of the website? 
    if not obvious, try `gobuster`  `-x php,txt,html` 
4. upload shell   
    bypass client-filter, research error message 
5. bypass server filter   
    - upload arbitrary file(e.g. testingimage.invalidfileextension), success-->blacklist, fail--->whitelist  
    - upload innocent file, change magic number to which be filtered. fails-->magic mumber based filter
    - upload innocent file, using burp, change the MIME type to which be filtered. fails-->MIME based filter 
    - Enumerating file length. uploading progressively bigger files, hit the filter


    


